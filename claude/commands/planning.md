# 作業のプランニングを行う

あなたの主目的は、与えられたタスクについて、探索と計画を ultrathink して行うことです。

**重要**: 計画の書き出しを除き、ファイルの書き込みを行わないこと。

---

## 入力タスクの前提

- タスクは自然言語で記述された箇条書き、または概要文で与えられることを想定している。
- コード、UI、設計、調査などジャンルを問わない。
- 特定のドメイン知識や依存先がある場合は、適宜調査・補完して進めること。

---

## 制約事項

- ファイルの書き込みを行うのは tmp/docs/planning/${日付/作業名}.md のみとすること
  - **それ以外のコードファイル、設定ファイル、外部APIへの書き込み操作は禁止**
- 出力結果の正確性に不安がある場合は明示して保留判断を提案すること

---

## 探索（背景・前提の把握）

- 該当タスクに関連するコードベース、依存モジュール、ドキュメントを調査する。
- 以下を優先的に把握すること：
  - 関連するユースケースとシステム構成
  - 外部依存（API・サービス・モジュール）
  - 過去の議論や類似実装
- 不明点や想定される前提の明文化も推奨される
- 設計上の考慮点はセクションを設けて記述すること
- 実装サンプルがある場合、計画書に含めること
- 実装時に考慮すべきファイルのパスを含めること。projectからみたときの相対パスにすること。

---

## 計画

- タスクを `todo` に分割すること。
  - 各タスクは「30分〜2時間」で完了できる粒度にする。
  - 作業の依存関係がある場合、順序を明示する。
  - コードの実装を行う場合、以下を**必ず守ること**
    - todoListの実装タスクの一つ前に、**t-wada TDD test**の実装タスクをtodo追加すること
- 各todoには、以下の説明をつけること：
  - **背景**: なぜその作業が必要になるのか？
  - **根拠**: その方法が妥当である理由（探索結果・過去事例・コードの構造など）
- `todo` 完了後、`tmp/doc/planning/${yyyy-mm-dd/作業名}.md`の形式でMarkdownを出力すること：

```markdown
# ${作業名}

## 概要

タスクの目的と背景を簡潔にまとめる。

## 背景・目的

- なぜこの作業が必要なのか
- 課題が発生している理由や業務上の重要性

## 現状の整理（探索結果）

- コードやドキュメントから得られた現状の情報を要約
- 関連ファイル、設定、インターフェースの記載

## todo（実施タスク一覧）

1. [タスクAのタイトル]
   - 背景: xxx
   - 根拠: yyy
2. ...

## 想定されるリスク・懸念点

- 未確認な仕様、依存、他メンバーとの調整が必要な点など

## 完了の定義（Definition of Done）

以下項目を明記
- テスト
- レビュー
```

## 完了後の確認ステップ

ユーザーに対し「asanaタスクにも実行計画を反映する必要があるか？」を確認する。
必要な場合は以下の出力テンプレートに則ってasanaタスクを作成:

```txt
タスク名: 実行計画タイトルを簡潔に

説明欄: 実行計画の要約（300文字以内）

サブタスク: todo の各項目と 1:1 で対応させて記載
```
